---
# Playbook to install fileserver, master and worker tools

## Prepare fileserver
- hosts: fileserver
  user: admin
  sudo: true
  roles:
    - private_ip
    - update
    - fileserver

# Install tool dependencies, slurm, mount volumes
- hosts:
  - master_private
  - workers
  vars_files:
    - inventory/cluster_data.yml
  user: admin
  sudo: true
  roles:
  - private_ip
  - update
  - core

# Install tools and other master things (Postgres, proFTPd, galaxy, etc)
- hosts: master_private
  vars_files:
    - roles/master/vars/tools.yml
    - roles/core/vars/main.yml
  sudo: true
  roles:
  - master

# Reboot remote systems
- hosts:
  - workers
  - master
  - fileserver
  sudo: true
  tasks:
    - name: Reboot system after provision
      command: /sbin/reboot
